
on: [push]

name: AzureCLISample

jobs:

  build-and-deploy:
    
    runs-on: self-hosted
    steps:
    
    - name: Azure Login
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    
    - name: Run script
      run: |
        az --version 
        printenv AZURE_HTTP_USER_AGENT
        az webapp create  -g testapps -p ASP-testapps-a893 -n thisnewghapp --runtime "node|6.2"
        az webapp delete --name thisnewghapp --resource-group testapps

    - name: Azure CLI script
      uses: azure/cli@v1
      with:
        inlineScript: |
          printenv AZURE_HTTP_USER_AGENT
          az webapp create  -g testapps -p ASP-testapps-a893 -n thisnewghapp --runtime "node|6.2"
          az webapp delete --name thisnewghapp --resource-group testapps
  test:
    needs: build-and-deploy
    runs-on: ubuntu-latest
    steps:
    - run: echo abc
